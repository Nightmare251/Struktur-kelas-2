<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Website Kelas 10 PPLG</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box;font-family:'Quicksand',sans-serif;}
body{min-height:100vh;background:#000;}

/* ===== LOGIN ===== */
section{position:absolute;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;gap:2px;flex-wrap:wrap;overflow:hidden;}
section::before{content:'';position:absolute;width:100%;height:100%;background:linear-gradient(#000,rgb(156,156,23),#000);animation:animate 5s linear infinite;}
@keyframes animate{0%{transform:translateY(-100%);}100%{transform:translateY(100%);}}
section span{position:relative;display:block;width:calc(6.25vw - 2px);height:calc(6.25vw - 2px);background:#181818;z-index:2;transition:1.5s;}
section span:hover{background:rgb(194,181,8);transition:0s;}

.signin{position:absolute;width:400px;background:#222;z-index:1000;display:flex;justify-content:center;align-items:center;padding:40px;border-radius:4px;box-shadow:0 15px 35px rgba(0,0,0,0.9);}
.signin .content{width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;gap:40px;}
.signin h2{font-size:2em;color:rgb(153,148,9);text-transform:uppercase;}
.form{width:100%;display:flex;flex-direction:column;gap:25px;}
.inputBox{position:relative;width:100%;}
.inputBox input{width:100%;background:#333;border:none;outline:none;padding:25px 10px 7.5px;border-radius:4px;color:#fff;font-weight:500;font-size:1em;}
.inputBox i{position:absolute;left:0;padding:15px 10px;color:#aaa;transition:0.5s;pointer-events:none;}
.inputBox input:focus ~ i, .inputBox input:valid ~ i{transform:translateY(-7.5px);font-size:0.8em;color:#fff;}
.inputBox input[type="submit"]{padding:10px;background: rgb(125,123,4);color:#000;font-weight:600;font-size:1.35em;cursor:pointer;letter-spacing:0.05em;}
input[type="submit"]:active{opacity:0.6;}

/* ===== MAIN PAGE ===== */
body.main-page{background:#fff;transition:all 0.3s ease;margin:0;}
.main-content{display:none;width:100%;min-height:100vh;position:relative;overflow:auto;padding-top:60px;transition:margin-left 0.3s ease;}



/* BACKGROUND */
.background-container{position:absolute;top:60px;left:0;width:100%;height:calc(100% - 60px);background-size:cover;background-position:center;z-index:0;transition: transform 1s ease, opacity 1s ease;}

/* TOP SPACE */
.top-space{position:fixed;top:0;left:0;width:100%;height:60px;background: rgba(200,200,200,0.5);z-index:100;}

/* SIDEBAR */
.theme-toggle{position:fixed;top:15px;right:20px;background:#DAA520;color:#000;border:none;padding:8px 12px;border-radius:5px;cursor:pointer;z-index:2000;transition:0.3s;}
.theme-toggle:hover{background:#C6930A;}
.hamburger{position:fixed;top:15px;left:20px;padding:10px;border:none;border-radius:5px;cursor:pointer;background-color:#DAA520;color:#000;z-index:1001;transition:0.3s;}
.hamburger:hover{background-color:#C6930A;}
.sidebar{position:fixed;top:60px;left:-220px;width:200px;height:calc(100% - 60px);background-color: rgba(255,255,255,0.9);backdrop-filter:blur(10px);padding-top:20px;box-shadow:2px 0 5px rgba(0,0,0,0.2);z-index:1000;transition:left 0.3s;}
.sidebar.open{left:0;}
.sidebar ul{list-style:none;padding:0;margin:0;}
.sidebar li{margin-bottom:10px;}
.sidebar a{display:block;padding:10px;text-decoration:none;color:#000;border-radius:4px;}
.sidebar a:hover{background:#C6930A;color:#fff;}

/* CONTENT */
.content{padding:20px;position:relative;z-index:1;transition: margin-left 0.3s ease;}

/* ===== PAGES ===== */
.page{display:none;position:relative;z-index:1;padding-top:20px;text-align:center;}

/* HOME */
#home{display:flex;justify-content:center;align-items:center;text-align:center;min-height: calc(100vh - 60px);position:relative;z-index:1;color:#fff;}

/* STRUKTUR KELAS */
#struktur{display:flex;flex-direction:column;gap:40px;align-items:center;}
.kelompok{display:flex;flex-direction:column;align-items:center;gap:15px;}
.anggotas{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;}
.anggota{display:flex;flex-direction:column;align-items:center;width:150px;position:relative;}
.anggota img{width:120px;height:120px;object-fit:cover;border-radius:50%;border:3px solid #555;cursor:pointer;}
.jabatan{margin-top:8px;font-weight:600;color:#DAA520;text-align:center;}
.nama{margin-top:4px;text-align:center;}
.delete-btn{position:absolute;top:5px; right:5px;background:red;color:#fff;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;display:none;}
.anggota.admin:hover .delete-btn{display:block;}

/* Gallery */
#gallery{color:#000;}
body.dark #gallery{color:#fff;}
#gallery .gallery{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:10px;}
#gallery .gallery img, #gallery .gallery video{width:150px;height:100px;object-fit:cover;border-radius:5px;cursor:pointer;}
#gallery button{margin:5px;padding:8px 12px;cursor:pointer;border:none;background:#DAA520;color:#000;border-radius:5px;}
#gallery button:hover{background:#C6930A;color:#fff;}

/* DARK MODE */
body.dark{background:#121212;color:#fff;}
body.dark .sidebar{background:#222;color:#fff;}
body.dark .sidebar a{color:#fff;}
body.dark .sidebar a:hover{background:#C6930A;color:#fff;}

/* LIGHTBOX */
#lightbox{position:fixed;top:0;left:0;width:100%;height:100%;background: rgba(0,0,0,0.8);display:none;justify-content:center;align-items:center;z-index:2000;}
#lightbox img, #lightbox video{max-width:90%;max-height:90%;border-radius:8px;box-shadow:0 0 20px rgba(0,0,0,0.5);}

/* FORM TAMBAH STRUKTUR */
#add-anggota-form{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
background:#222;padding:30px;border-radius:8px;z-index:3000;box-shadow:0 0 20px rgba(0,0,0,0.7);width:300px;}
#add-anggota-form h3{color:#DAA520;text-align:center;margin-bottom:15px;}
#add-anggota-form input, #add-anggota-form select{padding:10px;border-radius:5px;border:none;width:100%;margin-bottom:10px;}
#add-anggota-form button{padding:10px;border:none;border-radius:5px;cursor:pointer;margin-top:5px;}
#add-anggota-form .submit-btn{background:#DAA520;color:#000;font-weight:600;}
#add-anggota-form .cancel-btn{background:#C6930A;color:#fff;}

/* FORM TAMBAH AKUN WEBSITE */
#add-member-form{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
background:#222;padding:30px;border-radius:8px;z-index:3000;box-shadow:0 0 20px rgba(0,0,0,0.7);}
#add-member-form h3{color:#DAA520;text-align:center;margin-bottom:15px;}
#add-member-form input,#add-member-form select{padding:10px;border-radius:5px;border:none;width:100%;margin-bottom:10px;}
#add-member-form button{padding:10px;border:none;border-radius:5px;cursor:pointer;margin-top:5px;}
#add-member-form .submit-btn{background:#DAA520;color:#000;font-weight:600;}
#add-member-form .cancel-btn{background:#C6930A;color:#fff;}
</style>
</head>
<body>

<!-- LOGIN -->
<section id="login-page">
     <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <div class="signin">
        <div class="content">
            <h2>Sign In</h2>
            <form class="form">
                <div class="inputBox"><input type="text" id="username" required><i>Username</i></div>
                <div class="inputBox"><input type="password" id="password" required><i>Password</i></div>
                <div class="inputBox"><input type="submit" id="login-btn" value="Login"></div>
            </form>
        </div>
    </div>
</section>

<!-- MAIN CONTENT -->
<div id="main-content" class="main-content">
    <div class="top-space"></div>
    <div class="background-container"></div>
    <button class="theme-toggle" id="theme-toggle">Mode Gelap</button>
    <button class="hamburger" id="hamburger">â˜°</button>

    <div class="sidebar" id="sidebar">
        <ul>
            <li><a href="#home" data-page="home">Home</a></li>
            <li><a href="#struktur" data-page="struktur">Struktur Kelas</a></li>
            <li><a href="#gallery" data-page="gallery">Gallery</a></li>
            <li id="menu-tambah-akun" style="display:none;"><a href="#tambah-akun" data-page="tambah-akun">Tambah Akun Member</a></li>
        </ul>
    </div>

    <div class="content" id="content-area">
        <div class="page" id="home">
            <div class="background-container"></div>
            <h1>Selamat Datang di Website Kelas 10 PPLG</h1>
        </div>

        <!-- STRUKTUR KELAS -->
        <div class="page" id="struktur">
            <div class="kelompok">
                <h3>Pembina Kelas</h3>
                <div class="anggotas" id="pembina"></div>
            </div>
            <div class="kelompok">
                <h3>Anggota Inti</h3>
                <div class="anggotas" id="anggota-inti"></div>
            </div>
            <div class="kelompok">
                <h3>Anggota Lainnya</h3>
                <div class="anggotas" id="anggota-lain"></div>
            </div>

        </div>

        <!-- TAMBAH AKUN WEBSITE -->
        <div class="page" id="tambah-akun">
            <h2>Daftar Akun Member</h2>
            <div id="list-akun"></div>
        </div>

        <!-- GALLERY -->
        <div class="page" id="gallery">
            <button id="add-image">Tambah Gambar / Video</button>
            <div class="gallery"></div>
        </div>
    </div>
<!-- Lightbox -->
<div id="lightbox"></div>


<!-- FORM TAMBAH AKUN WEBSITE -->
<div id="add-member-form">
    <h3>Tambah Akun Member Website</h3>
    <form id="member-form">
        <input type="text" id="new-username" placeholder="Username" required>
        <input type="password" id="new-password" placeholder="Password" required>
        <select id="new-role" required>
            <option value="">Pilih Role</option>
            <option value="admin">Admin</option>
            <option value="member">Member</option>
        </select>
        <input type="submit" value="Buat Akun" class="submit-btn">
        <button type="button" id="cancel-member" class="cancel-btn">Batal</button>
    </form>
</div>



<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<!-- Supabase SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
// ===== FIREBASE CONFIG =====
const firebaseConfig = {
  apiKey: "AIzaSyAxQDonRxQDUikVefKbBUNoydmY4xAhNyE",
  authDomain: "website-kelas-4c071.firebaseapp.com",
  databaseURL: "https://website-kelas-4c071-default-rtdb.firebaseio.com",
  projectId: "website-kelas-4c071",
  storageBucket: "website-kelas-4c071.appspot.com",
  messagingSenderId: "596162787744",
  appId: "1:596162787744:web:86b959e4ee0a4f35a6ccc5"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const auth = firebase.auth();

// ===== GLOBAL =====
let activeUser = JSON.parse(localStorage.getItem("activeUser"));
const loginForm = document.querySelector('.form');
const loginPage = document.getElementById('login-page');
const mainContent = document.getElementById('main-content');
const galleryContainer = document.querySelector('#gallery .gallery');
const galleryBtn = document.getElementById('add-image');
const lightbox = document.getElementById('lightbox');

// ===== SUPABASE CONFIG =====
const supabaseUrl = "https://bzkphcyhegnpozcxdzqi.supabase.co";
const supabaseKey = "sb_publishable_BO-R8l0Psl1kvOrU5tWQcw_-KFMLDJV";
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

// ===== LOGIN =====
loginForm.addEventListener('submit', function(e){
    e.preventDefault();
    const username = document.getElementById('username').value.trim().toLowerCase();
    const password = document.getElementById('password').value.trim();
    const email = username.replace(/\s+/g, "_") + "@kelas-pplg.local";

    auth.signInWithEmailAndPassword(email, password)
        .then(userCredential=>{
            const user = userCredential.user;
            db.ref("users/"+user.uid).once("value").then(snapshot=>{
                const userData = snapshot.val();
                if(!userData){alert("Data user tidak ditemukan!");auth.signOut();return;}
                activeUser={uid:user.uid,username:userData.username,role:userData.role};
                localStorage.setItem("activeUser",JSON.stringify(activeUser));
                loginPage.style.display='none';
                mainContent.style.display='block';
                document.body.classList.add('main-page');
                showPage('home');
                if(activeUser.role==="admin") document.getElementById('menu-tambah-akun').style.display="block";
                initAdminWebsiteMember();
            });
        }).catch(error=>alert("Login gagal: "+error.message));
});

// ===== DARK MODE =====
document.getElementById('theme-toggle').addEventListener('click', ()=> {
    document.body.classList.toggle('dark');
    if(activeUser) localStorage.setItem("theme_"+activeUser.username,
        document.body.classList.contains("dark")?"dark":"light"
    );
});

// ===== SIDEBAR =====
const hamburger = document.getElementById('hamburger');
const sidebar = document.getElementById('sidebar');
const contentArea = document.getElementById('content-area');
hamburger.addEventListener('click', ()=>{sidebar.classList.toggle('open'); contentArea.style.marginLeft = sidebar.classList.contains('open')?'200px':'0';});

// ===== NAVIGATION =====
document.querySelectorAll('.sidebar a').forEach(link=>{
    link.addEventListener('click', e=>{
        e.preventDefault();
        showPage(link.dataset.page);
        sidebar.classList.remove('open'); contentArea.style.marginLeft='0';
    });
});
function showPage(pageId){
    document.querySelectorAll('.page').forEach(p=>p.style.display='none');
    const page = document.getElementById(pageId);
    if(page) page.style.display='block';
}

// Hanya tampilkan background di halaman home
function showPage(pageId){
    document.querySelectorAll('.page').forEach(p=>p.style.display='none');
    const page = document.getElementById(pageId);
    if(page) page.style.display='block';

    // Hanya tampilkan background jika page home
    const bgContainer = document.querySelector('.background-container');
    if(pageId === 'home'){
        bgContainer.style.display = 'block';
        bgContainer.style.backgroundImage = "url('99 kubah.jpg')"; // ganti gambar di sini
    } else {
        bgContainer.style.display = 'none';
    }
}



// ===== GALLERY SUPABASE =====
galleryBtn.addEventListener('click', () => {
    const fileInput = document.createElement('input');
    fileInput.type = "file";
    fileInput.accept = "image/*,video/*";

    fileInput.onchange = async e => {
        const file = e.target.files[0];
        if (!file) return;

        // ===== VALIDASI MIME TYPE =====
        const allowedTypes = ['image/jpeg','image/png','image/gif','video/mp4','video/webm'];
        if(!allowedTypes.includes(file.type)){
            alert("File tidak diizinkan! Hanya gambar atau video.");
            return;
        }
        // ============================

        const fileName = Date.now() + "_" + file.name;

        // upload ke Supabase
        const { error } = await supabase.storage
            .from('gallery')
            .upload(fileName, file, { cacheControl: '3600', upsert: false });

        if (error) {
            alert("Upload gagal: " + error.message);
            return;
        }

        // ambil URL publik
        const { data } = supabase.storage
            .from('gallery')
            .getPublicUrl(fileName);
        const url = data.publicUrl;

        const el = file.type.startsWith("image")
            ? document.createElement('img')
            : document.createElement('video');

        if (file.type.startsWith("video")) el.controls = true;
        el.src = url;

        el.addEventListener('click', () =>
            showLightbox(url, file.type.startsWith("video"))
        );

        galleryContainer.appendChild(el);
    };

    fileInput.click();
});

// ===== LIGHTBOX DENGAN ZOOM =====
function showLightbox(src, isVideo) {
    lightbox.innerHTML = '';
    lightbox.style.display = 'flex';
    lightbox.style.justifyContent = 'center';
    lightbox.style.alignItems = 'center';
    lightbox.style.background = 'rgba(0,0,0,0.8)';
    lightbox.style.overflow = 'hidden';

    const el = isVideo ? document.createElement('video') : document.createElement('img');
    el.src = src;
    if (isVideo) el.controls = true;

    // atur zoom awal
    let scale = 1;
    el.style.transition = 'transform 0.2s';
    el.style.maxWidth = '90%';
    el.style.maxHeight = '90%';

    // zoom dengan mouse wheel
    el.addEventListener('wheel', e => {
        e.preventDefault();
        if (e.deltaY < 0) scale *= 1.1; // zoom in
        else scale /= 1.1; // zoom out
        el.style.transform = `scale(${scale})`;
    });

    // tombol zoom in
    const zoomInBtn = document.createElement('button');
    zoomInBtn.textContent = '+';
    zoomInBtn.style.position = 'absolute';
    zoomInBtn.style.bottom = '20px';
    zoomInBtn.style.left = '50%';
    zoomInBtn.style.transform = 'translateX(-60px)';
    zoomInBtn.style.padding = '10px 15px';
    zoomInBtn.style.fontSize = '18px';
    zoomInBtn.style.cursor = 'pointer';
    zoomInBtn.style.borderRadius = '5px';
    zoomInBtn.style.border = 'none';
    zoomInBtn.style.background = '#fff';
    zoomInBtn.addEventListener('click', () => {
        scale *= 1.2;
        el.style.transform = `scale(${scale})`;
    });

    // tombol zoom out
    const zoomOutBtn = document.createElement('button');
    zoomOutBtn.textContent = '-';
    zoomOutBtn.style.position = 'absolute';
    zoomOutBtn.style.bottom = '20px';
    zoomOutBtn.style.left = '50%';
    zoomOutBtn.style.transform = 'translateX(60px)';
    zoomOutBtn.style.padding = '10px 15px';
    zoomOutBtn.style.fontSize = '18px';
    zoomOutBtn.style.cursor = 'pointer';
    zoomOutBtn.style.borderRadius = '5px';
    zoomOutBtn.style.border = 'none';
    zoomOutBtn.style.background = '#fff';
    zoomOutBtn.addEventListener('click', () => {
        scale /= 1.2;
        el.style.transform = `scale(${scale})`;
    });

    lightbox.appendChild(el);
    lightbox.appendChild(zoomInBtn);
    lightbox.appendChild(zoomOutBtn);

    // klik di luar untuk tutup lightbox
    lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) {
            lightbox.style.display = 'none';
            lightbox.innerHTML = '';
        }
    });
}

// ===== TAMBAH AKUN WEBSITE =====
function initAdminWebsiteMember(){
    if(activeUser.role!=="admin") return;
    const memberForm=document.getElementById("add-member-form");
    const listAkunDiv=document.getElementById("list-akun");

    document.getElementById("cancel-member").addEventListener('click', ()=>memberForm.style.display="none");

    document.getElementById("member-form").addEventListener("submit", function(e){
        e.preventDefault();
        const username=document.getElementById("new-username").value.trim().toLowerCase();
        const password=document.getElementById("new-password").value;
        const role=document.getElementById("new-role").value;
        if(!username||!password||!role) return alert("Lengkapi semua data!");
        const email=username.replace(/\s+/g,"_")+"@kelas-pplg.local";

        auth.createUserWithEmailAndPassword(email,password)
        .then(userCredential=>{
            const user=userCredential.user;
            db.ref("users/"+user.uid).set({username,role,online:false});
            alert("Akun berhasil dibuat!");
            memberForm.style.display="none";
            document.getElementById("member-form").reset();
        }).catch(err=>alert("Gagal: "+err.message));
    });

    document.querySelector('#menu-tambah-akun a').addEventListener('click', ()=>memberForm.style.display="block");

    db.ref("users").on("value", snapshot=>{
        listAkunDiv.innerHTML="";
        snapshot.forEach(s=>{
            const u=s.val(); const uid=s.key;
            const div=document.createElement('div');
            div.style.display="flex"; div.style.alignItems="center"; div.style.justifyContent="space-between"; div.style.marginBottom="5px";
            div.innerHTML=`<span>${u.username} (${u.role}) - ${u.online?'Online':'Offline'}</span>`;
            const delBtn=document.createElement('button');
            delBtn.textContent='Hapus'; delBtn.style.background='red'; delBtn.style.color='#fff'; delBtn.style.border='none'; delBtn.style.borderRadius='4px'; delBtn.style.padding='3px 6px';
            delBtn.onclick=()=>{if(confirm("Hapus akun ini?")) db.ref("users/"+uid).remove();};
            div.appendChild(delBtn);
            listAkunDiv.appendChild(div);
        });
    });

    const userStatusDatabaseRef = db.ref("/users/"+activeUser.uid+"/online");
    userStatusDatabaseRef.set(true);
    window.addEventListener('beforeunload', ()=>userStatusDatabaseRef.set(false));
}
</script>

<script>

// data awal: 1 pembina, 4 inti, 33 lainnya
const data = {
    pembina: [
        {
            foto: "assets/foto/pembina.jpg",
            jabatan: "Wali Kelas",
            nama: "Bu Amelia Chintani"
        }
    ],
    inti: [
        {
            foto: "assets/foto/ketua.jpg",
            jabatan: "Ketua Kelas",
            nama: "M. Kahfi Reski Pratama"
        },
        {
            foto: "assets/foto/wakil.jpg",
            jabatan: "Wakil Ketua",
            nama: "Muh. Azzam Adiyatma"
        },
        {
            foto: "assets/foto/sekretaris.jpg",
            jabatan: "Sekretaris",
            nama: "Ade Luna"
        },
        {
            foto: "assets/foto/bendahara.jpg",
            jabatan: "Bendahara",
            nama: "Nadya Zahira Nasrun"
        }
    ],
    lain: [
        { foto: "assets/foto/alya.jpg", nama: "Alya Nugraha" },
        { foto: "assets/foto/andi.jpg", nama: "Andi Dwi Fahrezi" }
    ]
};

function renderAll(){
    renderStruktur(data.pembina,'pembina','pembina');
    renderStruktur(data.inti,'anggota-inti','inti');
    renderStruktur(data.lain,'anggota-lain','lain');
}

renderAll();

function renderStruktur(list, id, roleType){
    const container = document.getElementById(id);
    container.innerHTML = '';

    list.forEach(u=>{
        const div = document.createElement('div');
        div.className = 'anggota';

        const img = document.createElement('img');
        img.src = u.foto || 'assets/foto/default.jpg';
        div.appendChild(img);

        if(roleType !== 'lain'){
            const jab = document.createElement('div');
            jab.className = 'jabatan';
            jab.textContent = u.jabatan || '';
            div.appendChild(jab);
        }

        const nama = document.createElement('div');
        nama.className = 'nama';
        nama.textContent = u.nama;
        div.appendChild(nama);

        container.appendChild(div);
    });
}



</script>
</body>
</html>
