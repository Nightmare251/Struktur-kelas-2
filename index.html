<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Website Kelas 10 PPLG</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap');
* { margin:0; padding:0; box-sizing:border-box; font-family:'Quicksand', sans-serif; }
body { min-height:100vh; background:#000; }

/* ===== LOGIN ===== */
section { position:absolute; width:100vw; height:100vh; display:flex; justify-content:center; align-items:center; gap:2px; flex-wrap:wrap; overflow:hidden; }
section::before { content:''; position:absolute; width:100%; height:100%; background:linear-gradient(#000, rgb(156,156,23), #000); animation:animate 5s linear infinite; }
@keyframes animate { 0%{transform:translateY(-100%);} 100%{transform:translateY(100%);} }
section span { position:relative; display:block; width:calc(6.25vw - 2px); height:calc(6.25vw - 2px); background:#181818; z-index:2; transition:1.5s; }
section span:hover { background: rgb(194, 181, 8); transition:0s; }

.signin { position:absolute; width:400px; background:#222; z-index:1000; display:flex; justify-content:center; align-items:center; padding:40px; border-radius:4px; box-shadow:0 15px 35px rgba(0,0,0,0.9); }
.signin .content { width:100%; display:flex; justify-content:center; align-items:center; flex-direction:column; gap:40px; }
.signin h2 { font-size:2em; color:rgb(153,148,9); text-transform:uppercase; }
.form { width:100%; display:flex; flex-direction:column; gap:25px; }
.inputBox { position:relative; width:100%; }
.inputBox input { width:100%; background:#333; border:none; outline:none; padding:25px 10px 7.5px; border-radius:4px; color:#fff; font-weight:500; font-size:1em; }
.inputBox i { position:absolute; left:0; padding:15px 10px; color:#aaa; transition:0.5s; pointer-events:none; }
.inputBox input:focus ~ i, .inputBox input:valid ~ i { transform:translateY(-7.5px); font-size:0.8em; color:#fff; }
.inputBox input[type="submit"] { padding:10px; background: rgb(125,123,4); color:#000; font-weight:600; font-size:1.35em; cursor:pointer; letter-spacing:0.05em; }
input[type="submit"]:active { opacity:0.6; }

/* ===== MAIN PAGE ===== */
body.main-page{ background:#fff; transition:all 0.3s ease; margin:0; }
.main-content{ display:none; width:100%; min-height:100vh; position:relative; overflow:auto; padding-top:60px; transition:margin-left 0.3s ease; }

/* BACKGROUND */
.background-container{
    position:absolute;
    top:60px;
    left:0;
    width:100%;
    height:calc(100% - 60px);
    background-size:cover;
    background-position:center;
    z-index:0;
    transition: transform 1s ease, opacity 1s ease;
}

/* TOP SPACE */
.top-space{ position:fixed; top:0; left:0; width:100%; height:60px; background: rgba(200,200,200,0.5); z-index:100; }

/* SIDEBAR */
.theme-toggle{ position:fixed; top:15px; right:20px; background:#DAA520; color:#000; border:none; padding:8px 12px; border-radius:5px; cursor:pointer; z-index:2000; transition:0.3s; }
.theme-toggle:hover{ background:#C6930A; }
.hamburger{ position:fixed; top:15px; left:20px; padding:10px; border:none; border-radius:5px; cursor:pointer; background-color:#DAA520; color:#000; z-index:1001; transition:0.3s; }
.hamburger:hover{ background-color:#C6930A; }

.sidebar{ position:fixed; top:60px; left:-220px; width:200px; height:calc(100% - 60px); background-color: rgba(255,255,255,0.9); backdrop-filter:blur(10px); padding-top:20px; box-shadow:2px 0 5px rgba(0,0,0,0.2); z-index:1000; transition:left 0.3s; }
.sidebar.open{ left:0; }
.sidebar ul{ list-style:none; padding:0; margin:0; }
.sidebar li{ margin-bottom:10px; }
.sidebar a{ display:block; padding:10px; text-decoration:none; color:#000; border-radius:4px; }
.sidebar a:hover{ background:#C6930A; color:#fff; }

/* CONTENT */
.content{ padding:20px; position:relative; z-index:1; transition: margin-left 0.3s ease; }

/* ===== PAGES ===== */
.page{ display:none; position:relative; z-index:1; padding-top:20px; text-align:center; }

/* HOME */
#home{ display:flex; justify-content:center; align-items:center; text-align:center; min-height: calc(100vh - 60px); position:relative; z-index:1; color:#fff; }

/* STRUKTUR KELAS */
#struktur {
  display: flex;
  flex-direction: column;
  gap: 40px;
  align-items: center;
}
.kelompok {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
}
.anggotas {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
}
.anggota {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 150px;
}
.anggota img {
  width: 120px;
  height: 120px;
  object-fit: cover;
  border-radius: 50%;
  border: 3px solid #555;
}
.jabatan {
  margin-top: 8px;
  font-weight: 600;
  color: #DAA520;
  text-align: center;
}
.nama {
  margin-top: 4px;
  text-align: center;
}

/* Gallery */
#gallery{ color:#000; }
body.dark #gallery{ color:#fff; }
#gallery .gallery{ display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin-top:10px; }
#gallery .gallery img, #gallery .gallery video{ width:150px; height:100px; object-fit:cover; border-radius:5px; cursor:pointer; }
#gallery button{ margin:5px; padding:8px 12px; cursor:pointer; border:none; background:#DAA520; color:#000; border-radius:5px; }
#gallery button:hover{ background:#C6930A; color:#fff; }

/* DARK MODE */
body.dark{ background:#121212; color:#fff; }
body.dark .sidebar{ background:#222; color:#fff; }
body.dark .sidebar a{ color:#fff; }
body.dark .sidebar a:hover{ background:#C6930A; color:#fff; }

/* LIGHTBOX */
#lightbox{ position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); display:none; justify-content:center; align-items:center; z-index:2000; }
#lightbox img, #lightbox video{ max-width:90%; max-height:90%; border-radius:8px; box-shadow:0 0 20px rgba(0,0,0,0.5); }
</style>
</head>
<body>

<!-- LOGIN -->
<section id="login-page">
     <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
     <div class="signin">
        <div class="content">
            <h2>Sign In</h2>
            <form class="form">
                <div class="inputBox"><input type="text" id="username" required><i>Username</i></div>
                <div class="inputBox"><input type="password" id="password" required><i>Password</i></div>
                <div class="inputBox"><input type="submit" id="login-btn" value="Login"></div>
            </form>
        </div>
    </div>
</section>

<!-- MAIN CONTENT -->
<div id="main-content" class="main-content">
    <div class="top-space"></div>
    <div class="background-container"></div>
    <button class="theme-toggle" id="theme-toggle">Mode Gelap</button>
    <button class="hamburger" id="hamburger">☰</button>

    <div class="sidebar" id="sidebar">
        <ul>
            <li><a href="#home" data-page="home">Home</a></li>
            <li><a href="#struktur" data-page="struktur">Struktur Kelas</a></li>
            <li><a href="#gallery" data-page="gallery">Gallery</a></li>
        </ul>
    </div>

    <div class="content" id="content-area">
        <div class="page" id="home">
            <h1>Selamat Datang di Website Kelas 10 PPLG</h1>
        </div>

        <!-- Struktur Kelas -->
        <div class="page" id="struktur">
            <div class="kelompok">
                <h3>Pembina Kelas</h3>
                <div class="anggotas" id="pembina"></div>
            </div>
            <div class="kelompok">
                <h3>Anggota Inti</h3>
                <div class="anggotas" id="anggota-inti"></div>
            </div>
            <div class="kelompok">
                <h3>Anggota Lainnya</h3>
                <div class="anggotas" id="anggota-lain"></div>
            </div>
        </div>

        <!-- Gallery -->
        <div class="page" id="gallery">
            <button id="add-image">Tambah Gambar / Video</button>
            <div class="gallery"></div>
        </div>
    </div>
</div>

<!-- Lightbox -->
<div id="lightbox"></div>

<script>
const loginForm = document.querySelector('.form');
const loginPage = document.getElementById('login-page');
const mainContent = document.getElementById('main-content');
</script>



<script>
// ===== DARK MODE =====
const themeToggle = document.getElementById('theme-toggle');
themeToggle.addEventListener('click', ()=> {
    document.body.classList.toggle('dark');
    const activeUser = JSON.parse(localStorage.getItem("activeUser"));
    if(activeUser) localStorage.setItem("theme_" + activeUser.username, document.body.classList.contains("dark") ? "dark" : "light");
});

// ===== SIDEBAR =====
const hamburger = document.getElementById('hamburger');
const sidebar = document.getElementById('sidebar');
const contentArea = document.getElementById('content-area');
hamburger.addEventListener('click', ()=> {
    sidebar.classList.toggle('open');
    contentArea.style.marginLeft = sidebar.classList.contains('open') ? '200px' : '0';
});

// ===== NAVIGATION =====
const menuLinks = document.querySelectorAll('.sidebar a');
menuLinks.forEach(link => {
    link.addEventListener('click', e=> {
        e.preventDefault();
        showPage(link.dataset.page);
        sidebar.classList.remove('open');
        contentArea.style.marginLeft = '0';
    });
});
function showPage(pageId){
    document.querySelectorAll('.page').forEach(p => p.style.display='none');
    document.getElementById(pageId).style.display='block';
    document.querySelector('.background-container').style.display = pageId==='home' ? 'block' : 'none';
}

// ===== STRUKTUR KELAS =====
const pembina = [
    { jabatan: "Pembina Kelas", nama: "Bu Amalia Chintani", foto:"foto_pembina.jpg" }
];
const anggotaInti = [
    { jabatan: "Ketua Kelas", nama:"M. Kahfi Reski Pratama", foto:"foto_ketua.jpg" },
    { jabatan: "Wakil Ketua", nama:"Muh. Azzam Adiyatma", foto:"foto_wakil.jpg" },
    { jabatan: "Bendahara", nama:"Nadya Zahira Nasrun", foto:"foto_bendahara.jpg" },
    { jabatan: "Sekretaris", nama:"Ade Luna Aulia", foto:"foto_sekretaris.jpg" }
];
const anggotaLain = []; // nanti bisa ditambah admin

function renderStruktur(){
    const containerPembina = document.getElementById('pembina');
    pembina.forEach(a=>{
        const div = document.createElement('div');
        div.classList.add('anggota');
        div.innerHTML = `<img src="${a.foto}"><div class="jabatan">${a.jabatan}</div><div class="nama">${a.nama}</div>`;
        containerPembina.appendChild(div);
    });
    const containerInti = document.getElementById('anggota-inti');
    anggotaInti.forEach(a=>{
        const div = document.createElement('div');
        div.classList.add('anggota');
        div.innerHTML = `<img src="${a.foto}"><div class="jabatan">${a.jabatan}</div><div class="nama">${a.nama}</div>`;
        containerInti.appendChild(div);
    });
}
renderStruktur();

// ===== GALLERY & LIGHTBOX =====
let galleryData = [];
const galleryBtn = document.getElementById('add-image');
const galleryContainer = document.querySelector('#gallery .gallery');
const lightbox = document.getElementById('lightbox');
const activeUser = JSON.parse(localStorage.getItem("activeUser"));

// Upload manual
galleryBtn.addEventListener('click', () => {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*,video/*';
    input.multiple = true;
    input.click();
    input.addEventListener('change', () => handleGalleryFiles(input.files));
});

// Drag & Drop
galleryContainer.addEventListener('dragover', e => { e.preventDefault(); galleryContainer.style.border = "2px dashed gold"; });
galleryContainer.addEventListener('dragleave', () => { galleryContainer.style.border = "none"; });
galleryContainer.addEventListener('drop', e => { e.preventDefault(); galleryContainer.style.border = "none"; if (e.dataTransfer.files.length > 0) handleGalleryFiles(e.dataTransfer.files); });

function handleGalleryFiles(files){
    [...files].forEach(file => {
        const reader = new FileReader();
        reader.onload = function(e){
            galleryData.push({ type:file.type.startsWith("video")?"video":"image", src:e.target.result });
            saveGallery(); renderGallery();
        };
        reader.readAsDataURL(file);
    });
}

function renderGallery(){
    galleryContainer.innerHTML = "";
    galleryData.forEach((item,index)=>{
        const wrapper = document.createElement("div"); 
        wrapper.classList.add("gallery-item");
        if(item.type==="image") wrapper.innerHTML = `<img src="${item.src}" class="gallery-img">`;
        else wrapper.innerHTML = `<video class="gallery-video" controls><source src="${item.src}"></video>`;
        wrapper.addEventListener("click", ()=>openLightbox(item.src,item.type));
        wrapper.addEventListener("contextmenu", e=>{ e.preventDefault(); if(activeUser && activeUser.role==="admin"){ if(confirm("Hapus foto/video ini?")){ galleryData.splice(index,1); saveGallery(); renderGallery(); } } else alert("Hanya admin yang bisa menghapus file!"); });
        galleryContainer.appendChild(wrapper);
    });
}

// Lightbox
function openLightbox(src,type){ 
    lightbox.innerHTML=""; 
    lightbox.style.display="flex"; 
    const container = document.createElement("div");
    container.style.position="relative"; container.style.cursor="grab"; container.style.transition="transform 0.3s ease"; container.style.maxWidth="90%"; container.style.maxHeight="90%"; container.style.display="flex"; container.style.justifyContent="center"; container.style.alignItems="center"; container.style.overflow="hidden";
    let scale = 1;
    if(type==="video"){ 
        const v = document.createElement("video"); v.src = src; v.controls = true; v.autoplay = true; v.style.maxWidth="100%"; v.style.maxHeight="100%"; container.appendChild(v);
    } else{ 
        const i = document.createElement("img"); i.src = src; i.style.maxWidth="100%"; i.style.maxHeight="100%"; container.appendChild(i);
    }
    lightbox.appendChild(container);
    container.addEventListener("wheel", e=>{ e.preventDefault(); if(e.deltaY<0) scale+=0.1; else scale-=0.1; scale=Math.min(Math.max(0.2,scale),5); container.style.transform=`scale(${scale})`; });
}
lightbox.addEventListener("click", ()=>lightbox.style.display="none");



// ===== BACKGROUND SLIDE =====
const bgContainer = document.querySelector('.background-container');
const bgImages = ['perkumpulan.jpg','kemerdekaan.jpg','99 kubah.jpg'];
let currentBg=0, lastChangeTime=Date.now();
bgContainer.style.backgroundImage = `url('${bgImages[currentBg]}')`;

function changeBgSlide(){
    const now = Date.now();
    if(now - lastChangeTime < 3000) return;
    lastChangeTime = now;
    bgContainer.style.transform='translateX(-100%)';
    bgContainer.style.opacity='0';
    setTimeout(()=>{
        currentBg=(currentBg+1)%bgImages.length;
        bgContainer.style.backgroundImage=`url('${bgImages[currentBg]}')`;
        bgContainer.style.transform='translateX(100%)';
        setTimeout(()=>{ bgContainer.style.transform='translateX(0)'; bgContainer.style.opacity='1'; },50);
    },1000);
}
setInterval(changeBgSlide,1000);
</script>


<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>


<script>
const firebaseConfig = {
  apiKey: "AIzaSyDO6C7PexZDKuyOxhpnLIFL3aEgqn8Ypr4",
  authDomain: "justboring-6e2c0.firebaseapp.com",
  databaseURL: "https://justboring-6e2c0-default-rtdb.firebaseio.com",
  projectId: "justboring-6e2c0",
  storageBucket: "justboring-6e2c0.appspot.com",
  messagingSenderId: "1051750552120",
  appId: "1:1051750552120:web:4250ef8dea6f9b63c90ccd"
};

// INIT FIREBASE (INI YANG BENAR)
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const storage = firebase.storage();
const auth = firebase.auth();
</script>

<script>

// LOGIN
loginForm.addEventListener('submit', function(e){
    e.preventDefault();

    const username = document.getElementById('username').value.trim().toLowerCase();
    const password = document.getElementById('password').value.trim();

    // username → email palsu
    const email = username.replace(/\s+/g, "_") + "@kelas-pplg.local";

    auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
            const user = userCredential.user;

            // Ambil role dari database
            db.ref("users/" + user.uid).once("value").then(snapshot => {
                const userData = snapshot.val();

                if(!userData){
                    alert("Data user tidak ditemukan!");
                    auth.signOut();
                    return;
                }

                localStorage.setItem("activeUser", JSON.stringify({
                    uid: user.uid,
                    username: userData.username,
                    role: userData.role
                }));

                loginPage.style.display = 'none';
                mainContent.style.display = 'block';
                document.body.classList.add('main-page');

                showPage('home');
            });
        })
        .catch((error) => {
            alert("Login gagal: " + error.message);
        });
});
</script>

<script>

// ===== GALLERY FIREBASE =====
function uploadGalleryFile(file){
    const storageRef = storage.ref('gallery/' + Date.now() + '_' + file.name);
    const uploadTask = storageRef.put(file);

    uploadTask.on('state_changed', null, 
        (error) => console.error(error), 
        () => {
            uploadTask.snapshot.ref.getDownloadURL().then((url)=>{
                db.ref('gallery').push({
                    src: url,
                    type: file.type.startsWith('video') ? 'video' : 'image'
                });
            });
        }
    );
}

// Ambil data gallery realtime
function renderGalleryFromFirebase(){
    db.ref('gallery').on('value', (snapshot)=>{
        galleryContainer.innerHTML = '';
        const data = snapshot.val();
        if(data){
            Object.values(data).forEach(item=>{
                const wrapper = document.createElement('div');
                wrapper.classList.add('gallery-item');
                if(item.type === 'image') wrapper.innerHTML = `<img src="${item.src}" class="gallery-img">`;
                else wrapper.innerHTML = `<video src="${item.src}" controls class="gallery-video"></video>`;

                wrapper.addEventListener("click", ()=>openLightbox(item.src, item.type));

                // Hanya admin bisa hapus
                wrapper.addEventListener("contextmenu", e=>{
                    e.preventDefault();
                    const activeUser = JSON.parse(localStorage.getItem("activeUser"));
                    if(activeUser && activeUser.role==="admin"){
                        if(confirm("Hapus foto/video ini?")){
                            // Hapus dari firebase database & storage
                            db.ref('gallery').orderByChild('src').equalTo(item.src).once('value', snap=>{
                                snap.forEach(s => s.ref.remove());
                            });
                            storage.refFromURL(item.src).delete().catch(()=>{});
                        }
                    } else alert("Hanya admin yang bisa menghapus file!");
                });

                galleryContainer.appendChild(wrapper);
            });
        }
    });
}

// Override tombol upload lama agar upload ke Firebase
galleryBtn.addEventListener('click', () => {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*,video/*';
    input.multiple = true;
    input.click();
    input.addEventListener('change', () => {
        [...input.files].forEach(file => uploadGalleryFile(file));
    });
});

// Jalankan render realtime
renderGalleryFromFirebase();
</script>

</body>
</html>

